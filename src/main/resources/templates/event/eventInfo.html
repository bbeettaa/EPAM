<!DOCTYPE html>
<html lang="${language}" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <title>Event info</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <style>

        .align-left {
            float: left;
        }

        .align-right {
            float: left;
            margin-left: 15px;
        }
    </style>
</head>
<body>

<div th:insert="templates :: navbar"/>

<div class="container-fluid text-center">
    <div class="row content">

        <div class="col-sm-2 sidenav" style="height: 100%">
            <div th:fragment="navbar">
                <div sec:authorize="hasRole('ROLE_MODERATOR')">
                    <div class="well">
                        <a th:href="@{/report/new/{eventId}(eventId=${event.getId()})}"
                           th:text="#{title.createReport}"></a>
                        <br>
                    </div>
                </div>

                <div sec:authorize="hasRole('ROLE_SPEAKER')">
                    <div class="well">
                        <a th:href="@{/report/new/{eventId}(eventId=${event.getId()})}"
                           th:text="#{title.suggestReport}"></a>
                        <br>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-sm-8 text-left">
            <table class="table table-hover">
                <caption style="font-size:160%;" th:text="#{title.eventInfo}"></caption>
                <tr>
                    <div sec:authorize="hasRole('ROLE_MODERATOR')">
                        <th th:text="#{label.event.id}"></th>
                    </div>
                    <th th:text="#{label.event.name}"></th>
                    <th th:text="#{label.event.date}"></th>
                    <td th:text="#{label.event.time}"></td>
                    <th th:text="#{label.event.reports}"></th>
                    <th th:text="#{label.event.subs}"></th>
                    <th th:text="#{label.event.joined}"></th>
                    <th sec:authorize="hasRole('ROLE_MODERATOR')"></th>
                    <th sec:authorize="hasRole('ROLE_MODERATOR')"></th>
                    <th sec:authorize="hasRole('ROLE_MODERATOR')"></th>
                    <th sec:authorize="hasRole('ROLE_USER')" th:if="${event.isActive()}"></th>
                </tr>
                <tr>
                    <ul>
                        <div sec:authorize="hasRole('ROLE_MODERATOR')">
                            <td th:text="${event.getId()}"></td>
                        </div>
                        <td th:text="${event.getName()}"></td>
                        <td th:text="${event.getDateBegin()}"></td>
                        <td th:text="${event.getTimeBegin}"></td>
                        <td th:text="${event.getReports()}"></td>
                        <td th:text="${event.getSubscribers()}"></td>
                        <td><p th:text="${statistic}"></p></td>
                        <td sec:authorize="hasRole('ROLE_MODERATOR')">
                            <form method="get" th:action="@{/event/{id}/edit(id=${event.getId()})}"
                                  id="updateEv">
                                <input type="submit" class="btn btn-info" th:value="#{label.button.updateInfo}"/>
                            </form>
                        </td>
                        <td sec:authorize="hasRole('ROLE_MODERATOR')">
                            <form method="post" th:action="@{/event/{id}/remove(id=${event.getId()})}"
                                  id="dellEv">
                                <input type="submit" class="btn btn-danger" th:value="#{label.button.delete}"/>
                            </form>
                        </td>
                        <td sec:authorize="hasRole('ROLE_MODERATOR')">
                            <div th:if="not ${event.isActive()}">
                                <form method="post" th:action="@{/moderator/{id}/start(id=${event.getId()})}"
                                      id="start1">
                                    <input type="submit" class="btn btn-warning" th:value="#{label.button.start}"/>
                                </form>
                            </div>
                            <div th:if="${event.isActive()}">
                                <form method="post" th:action="@{/moderator/{id}/stop(id=${event.getId()})}" id="start">
                                    <input type="submit" class="btn btn-primary" th:value="#{label.button.stop}"/>
                                </form>
                            </div>
                        </td>
                        <!--Join-->
                        <td sec:authorize="hasRole('ROLE_USER')">
                            <div th:if="${event.isActive()}">
                                <form method="post" th:action="@{/user/{id}/connect(id=${event.getId()})}">
                                    <input type="submit" class="btn btn-warning" th:value="#{label.button.join}"/>
                                </form>
                            </div>

                        </td>
                    </ul>
                </tr>
            </table>

            <table class="table table-hover">
                <caption style="font-size:160%;" th:text="#{title.allReports}"></caption>
                <tr>
                    <th th:text="#{label.report.id}"></th>
                    <th th:text="#{label.report.name}"></th>
                    <th th:text="#{label.speaker.name}"></th>
                    <th th:text="#{label.speaker.login}"></th>
                    <th></th>
                    <th></th>
                </tr>
                <div th:each="report : ${entities}">
                    <tr>
                        <ul>
                            <td th:text="${report.getId()}"></td>
                            <td th:text="${report.getName()}"></td>
                            <td>
                                <div class="align-left" th:text="${report.getSpeaker().getName()}">left</div>
                                <div class="align-right" th:text="${report.getSpeaker().getSurname()}">right</div>
                            </td>
                            <td th:text="${report.getSpeaker().getLogin()}"></td>
                            <div sec:authorize="hasRole('ROLE_SPEAKER')">
                                <td>
                                    <div th:if="${report.getSpeaker().getLogin()==user}">
                                        <form method="get" th:action="@{/report/{id}/edit(id=${report.getId()})}">
                                            <input type="submit" class="btn btn-info"
                                                   th:value="#{label.button.updateInfo}"/>
                                        </form>
                                    </div>
                                </td>
                                <td>
                                    <div th:if="${report.getSpeaker().getLogin()==user}">
                                        <form method="post" th:action="@{/report/{id}/remove(id=${report.getId()})}">
                                            <input type="submit" class="btn btn-danger"
                                                   th:value="#{label.button.delete}"/>
                                        </form>
                                    </div>
                                </td>
                                </td>
                            </div>
                            <div sec:authorize="hasRole('ROLE_MODERATOR')">
                                <td>
                                    <form method="get" th:action="@{/report/{id}/edit(id=${report.getId()})}">
                                        <input type="submit" class="btn btn-info"
                                               th:value="#{label.button.updateInfo}"/>
                                    </form>
                                </td>
                                <td>
                                    <form method="post" th:action="@{/report/{id}/remove(id=${report.getId()})}">
                                        <input type="submit" class="btn btn-danger" th:value="#{label.button.delete}"/>
                                    </form>
                                </td>
                            </div>

                        </ul>
                    </tr>
                </div>


            </table>


        </div>
    </div>
</div>


</body>
</html>
